<ng-container *ngIf="project">
  <h1>{{ project.config.name }}</h1>
  <div *ngIf="project" class="project">
    <div>
      <button
        (click)="currentTranslation = translation"
        *ngFor="let translation of project.output.translations"
      >
        {{ translation.locale }}
      </button>
      <button (click)="save()">SAVE</button>
    </div>
    <table
      *ngIf="table && currentTranslation"
      class="table"
    >
      <thead>
      <tr>
        <th>
          <input
            [(ngModel)]="idFilter"
            placeholder="ID"
            type="text"
          >
        </th>
        <th>
          <select [(ngModel)]="typeFilter">
            <option value="">All types</option>
            <option value="same">Same</option>
            <option value="new">New</option>
            <option value="changed">Changed</option>
            <option value="deleted">Deleted</option>
          </select>
        </th>
        <th>Prev Source</th>
        <th>Current Source</th>
        <ng-container *ngIf="currentTranslation">
          <th>
            Target ({{ currentTranslation.locale }})
          </th>
        </ng-container>
      </tr>
      </thead>
      <tbody>
      <ng-container *ngFor="let row of table">
        <tr
          *ngIf="(!idFilter || row.id.toLowerCase().indexOf(idFilter.toLowerCase()) !== -1) && (!typeFilter || row.type === typeFilter)"
          [ngClass]="['-' + row.type]"
        >
          <td>{{ row.id }}</td>
          <td>{{ row.type }}</td>
          <td>{{ row.prev }}</td>
          <td>{{ row.current }}</td>
          <td>
            <ng-container *ngIf="row.type !== 'deleted'">
              <input
                [(ngModel)]="currentTranslation.translations[row.id]"
                type="text"
              >
            </ng-container>
            <ng-container *ngIf="row.type === 'deleted'">
              {{ row.target }}
            </ng-container>
          </td>
        </tr>
      </ng-container>
      </tbody>
    </table>
  </div>
  <pre>
    {{ project | json }}
  </pre>
</ng-container>
